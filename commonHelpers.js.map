{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["// Підключення необхідних бібліотек\nimport axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\n// Очікування завантаження сторінки\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n\n  // Отримання елементів DOM\n  const form = document.querySelector(\".searchForm\");\n  const searchInput = document.querySelector(\".searchInput\");\n  const loader = document.querySelector(\".loader\");\n  const gallery = document.querySelector(\".gallery\");\n  const loadButton = document.querySelector(\".load-more-button\");\n\n  // Ключ та URL API Pixabay\n  const apiKey = \"42055816-5ec499474650eadfc6b07a02f\";\n  const apiUrl = \"https://pixabay.com/api/\";\n\n  // Кількість зображень на сторінці\n  const PER_PAGE = 15;\n\n  // Ініціалізація lightbox для перегляду зображень\n  const lightbox = new SimpleLightbox('.gallery a', {\n    captionDelay: 250,\n    captionsData: 'alt',\n  });\n\n  // Поточна сторінка для пагінації\n  let currentPage = 1;\n\n  // Масив для збереження данних введених в Imput форми\n  let arr = [];\n\n  // Обробник події для форми пошуку\n  form.addEventListener(\"submit\", async (event) => {\n    event.preventDefault();\n\n    // Отримання терміну пошуку та пушимо в масив\n    const searchTerm = searchInput.value.trim();\n    arr = [];\n    arr.push(searchTerm);\n\n    if (searchTerm === \"\") {\n      // Виведення помилки, якщо термін пошуку порожній\n      iziToast.error({\n        title: \"Error\",\n        messageColor: '#fff',\n        messageSize: '20px',\n        backgroundColor: '#EF4040',\n        position: \"topRight\",\n        message: \"Please enter a search term.\",\n      });\n      return;\n    }\n\n    // Показати лоадер та очистити галерею та приховати кнопку \"Load More\"\n    loader.classList.remove(\"hidden\");\n    gallery.innerHTML = \"\";\n    loadButton.classList.add(\"hidden\");\n    currentPage = 1;\n\n    try {\n      // Отримання та відображення даних\n      await fetchData(searchTerm, currentPage);\n\n    } catch (error) {\n      // Обробка помилок під час отримання даних\n      console.error(error);\n      iziToast.error({\n        title: \"Error\",\n        messageColor: '#fff',\n        messageSize: '20px',\n        backgroundColor: '#EF4040',\n        position: \"topRight\",\n        message: \"An error occurred while fetching data. Please try again.\",\n      });\n    } finally {\n      // Приховати лоадер після завершення операції\n      loader.classList.add(\"hidden\");\n    }\n\n    // Очищаємо Imput форми\n    form.reset();\n  });\n\n  // Обробник події для кнопки \"Load More\"\n  loadButton.addEventListener(\"click\", () => {\n    // Показати лоадер та приховати кнопку \"Load More\"\n    loader.classList.remove(\"hidden\");\n    loadButton.classList.add(\"hidden\");\n    // Збільшити поточну сторінку та отримати додаткові дані\n    currentPage++;\n    fetchData(arr, currentPage);\n  });\n\n  // Функція для отримання та відображення даних\n  async function fetchData(searchTerm, page = 1) {\n    try {\n      // Отримання даних з API Pixabay\n      const params = new URLSearchParams({\n        key: apiKey,\n        q: searchTerm,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page: page,\n        per_page: PER_PAGE,\n      });\n      const response = await axios.get(`${apiUrl}?${params}`);\n            \n      if (response.status !== 200) {\n        // Якщо отримано неочікуваний HTTP-відповідь, вивести помилку\n        throw new Error(`HTTP error! Status: ${response.status}`);\n      }\n\n      const data = response.data;\n\n      if (data.hits.length === 0) {\n        // Якщо немає зображень, приховати кнопку \"Load More\" та вивести інформаційне повідомлення\n        loadButton.classList.add(\"hidden\");\n        iziToast.show({\n          title: '',\n          messageColor: '#fff',\n          messageSize: '20px',\n          backgroundColor: '#EF4040',\n          message: \"Sorry, there are no images matching your search query. Please try again!\",\n          position: 'topRight',\n        });\n      } else {\n        // Якщо є зображення, відобразити їх та показати/приховати кнопку \"Load More\"\n        const images = data.hits.map((hit) => ({\n          webformatURL: hit.webformatURL,\n          largeImageURL: hit.largeImageURL,\n          tags: hit.tags,\n          likes: hit.likes,\n          views: hit.views,\n          comments: hit.comments,\n          downloads: hit.downloads,\n        }));\n\n        displayImages(images);\n\n        if (data.totalHits > page * PER_PAGE) {\n          loadButton.classList.remove(\"hidden\");\n        } else {\n          loadButton.classList.add(\"hidden\");\n          iziToast.show({\n          title: 'End of Collection',\n          messageColor: '#fff',\n          messageSize: '20px',\n          backgroundColor: '#EF4040',\n          message: \"We're sorry, but you've reached the end of search results.\",\n          position: 'bottomCenter',\n        });\n        }\n      }\n    } catch (error) {\n      // Обробка помилок, які можуть виникнути під час отримання даних\n      console.error(error);\n      iziToast.error({\n        title: \"Error\",\n        messageColor: '#fff',\n        messageSize: '20px',\n        backgroundColor: '#EF4040',\n        position: \"topRight\",\n        message: \"Sorry, there are no images matching your search query. Please try again!\",\n      });\n    } finally {\n      // Приховати лоадер після завершення операції\n      loader.classList.add(\"hidden\");\n    }\n\n  }\n\n  // Функція для відображення зображень на сторінці\n  function displayImages(images) {\n    const galleryHTML = images\n      .map(\n        (image) => `\n          <div class=\"gallery-item\">\n            <a href=\"${image.largeImageURL}\" data-lightbox=\"gallery\" data-title=\"${image.tags}\">\n              <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" class=\"image-thumbnail\">\n            </a>\n            <div class=\"image-details\">\n              <p><b>Likes:</b> ${image.likes}</p>\n              <p><b>Views:</b> ${image.views}</p>\n              <p><b>Comments:</b> ${image.comments}</p>\n              <p><b>Downloads:</b> ${image.downloads}</p>\n            </div>\n          </div>\n        `\n      )\n      .join(\"\");\n\n    // Додати HTML для зображень в галерею\n    gallery.innerHTML += galleryHTML;\n\n    // Оновити lightbox після додавання нових зображень\n    lightbox.refresh();\n\n    // Прокрутити сторінку так, щоб користувач міг побачити нові зображення\n    const cardHeight = document.querySelector('.gallery-item')?.getBoundingClientRect().height;\n    if (cardHeight) {\n      smoothScrollBy(cardHeight * images.length, 5000);\n    }\n  }\n\n  // Функція для плавної прокрутки сторінки\n  function smoothScrollBy(distance, duration) {\n    const initialY = window.scrollY;\n    const targetY = initialY + distance;\n\n    let startTime = null;\n\n    function scrollAnimation(currentTime) {\n      if (!startTime) {\n        startTime = currentTime;\n      }\n\n      const progress = currentTime - startTime;\n      const elapsedTime = Math.min(progress, duration);\n\n      const easeInOutQuad = (t) => t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\n\n      window.scrollTo(0, initialY + easeInOutQuad(elapsedTime / duration) * distance);\n\n      if (progress < duration) {\n        requestAnimationFrame(scrollAnimation);\n      }\n    }\n\n    requestAnimationFrame(scrollAnimation);\n  }\n});\n"],"names":["form","searchInput","loader","gallery","loadButton","apiKey","apiUrl","PER_PAGE","lightbox","SimpleLightbox","currentPage","arr","event","searchTerm","iziToast","fetchData","error","page","params","response","axios","data","images","hit","displayImages","galleryHTML","image","cardHeight","_a","smoothScrollBy","distance","duration","initialY","startTime","scrollAnimation","currentTime","progress","elapsedTime","easeInOutQuad","t"],"mappings":"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"}